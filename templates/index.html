{% extends 'base.html' %}

{% block title %}Accueil - Robot Monitoring{% endblock %}

{% block content %}
<div class="welcome-section">
  
  {% if user.is_authenticated %}
    <div class="user-greeting">
      <span class="greeting-icon">üëã</span>
      <p>Bonjour, <strong>{{ user.first_name }}</strong> ! Vous √™tes connect√©.</p>
    </div>
    
    <div class="dashboard-overview">
      <div class="dashboard-row">
        <!-- Panneau de statistiques -->
        <div class="dashboard-panel stats-panel">
          <h3>Aper√ßu du syst√®me</h3>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-icon">ü§ñ</div>
              <div class="stat-info">
                <span class="stat-value">{{ robots_count|default:"0" }}</span>
                <span class="stat-label">Robots</span>
              </div>
            </div>
            <div class="stat-item">
              <div class="stat-icon">‚úÖ</div>
              <div class="stat-info">
                <span class="stat-value">{{ active_robots|default:"0" }}</span>
                <span class="stat-label">Actifs</span>
              </div>
            </div>
            <div class="stat-item">
              <div class="stat-icon">‚ö†Ô∏è</div>
              <div class="stat-info">
                <span class="stat-value">{{ alerts_count|default:"0" }}</span>
                <span class="stat-label">Alertes</span>
              </div>
            </div>
            <div class="stat-item">
              <div class="stat-icon">üìä</div>
              <div class="stat-info">
                <span class="stat-value">{{ tasks_count|default:"0" }}</span>
                <span class="stat-label">T√¢ches</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Section de notifications internes (version compacte) -->
        <div class="notifications-panel">
          <h3>Derni√®res mises √† jour</h3>
          <div class="notification-list">
            {% if notifications %}
              {% for notification in notifications %}
                <div class="notification-item">
                  <div class="notification-header">
                    <span class="notification-date">{{ notification.date }}</span>
                    <span class="notification-badge {% if notification.priority == 'high' %}high-priority{% elif notification.priority == 'medium' %}medium-priority{% else %}low-priority{% endif %}">
                      {{ notification.priority|title }}
                    </span>
                  </div>
                  <h4 class="notification-title">{{ notification.title }}</h4>
                  <p class="notification-content">{{ notification.content }}</p>
                  {% if notification.url %}
                    <a href="{{ notification.url }}" target="_blank" class="notification-link">Voir le commit</a>
                  {% endif %}
                </div>
              {% endfor %}
            {% else %}
              <div class="notification-empty">
                <p>Aucune mise √† jour r√©cente</p>
              </div>
            {% endif %}
          </div>
          <div class="notification-footer">
            <a href="https://github.com/LeroyDu56/CDA_FINAL_ARMIN/commits/main" target="_blank" class="view-more-link">
              Voir toutes les mises √† jour
            </a>
          </div>
        </div>
      </div>
      
      <!-- Actions rapides -->
      <div class="quick-actions">
        <h3>Actions rapides</h3>
        <div class="action-buttons">
          {% if not user_is_visitor %}
            <a href="{% url 'robot_list' %}" class="action-button">
              <span class="action-icon">üìã</span>
              <span class="action-text">Liste des robots</span>
            </a>
          {% endif %}
          {% if user.is_staff %}
            <a href="{% url 'admin_roles' %}" class="action-button">
              <span class="action-icon">‚öôÔ∏è</span>
              <span class="action-text">Administration</span>
            </a>
          {% endif %}
          <a href="#" class="action-button">
            <span class="action-icon">üìä</span>
            <span class="action-text">Statistiques</span>
          </a>
          <a href="#" class="action-button">
            <span class="action-icon">‚ùì</span>
            <span class="action-text">Aide</span>
          </a>
        </div>
      </div>
    </div>
  {% else %}
    <div class="login-prompt">
      <p>Veuillez vous connecter ou vous inscrire pour acc√©der aux fonctionnalit√©s de monitoring.</p>
      <div class="auth-buttons">
        <a href="{% url 'login' %}" class="auth-button login-btn">Connexion</a>
        <a href="{% url 'register' %}" class="auth-button register-btn">Inscription</a>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}