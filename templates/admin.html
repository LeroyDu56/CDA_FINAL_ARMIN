<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Admin - Robot Monitoring</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  {% include 'header.html' %}
  <main class="container">
    <h2>Gestion des rôles utilisateurs</h2>
    <p>Attribuez des rôles aux utilisateurs inscrits.</p>

    <table>
        <thead>
            <tr>
                <th>Email</th>
                <th>Prénom</th>
                <th>Nom</th>
                <th>Dernière IP</th>
                <th>Rôle actuel</th>
                <th>Attribuer un rôle</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.email }}</td>
                <td>{{ user.first_name }}</td>
                <td>{{ user.last_name }}</td>
                <td>{{ user.last_ip if user.last_ip else 'Non disponible' }}</td>
                <td>{{ user.current_role if user.current_role else 'Aucun' }}</td>
                <td>
                    <form method="POST" action="{{ url_for('assign_role') }}">
                        <input type="hidden" name="user_id" value="{{ user.id }}">
                        <select name="role_id">
                            {% for role in roles %}
                                <option value="{{ role.role_id }}" {% if role.name == user.current_role %}selected{% endif %}>
                                    {{ role.name }}
                                </option>
                            {% endfor %}
                        </select>
                        <button type="submit">Attribuer</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
  </main>
  {% include 'footer.html' %}
</body>
</html>
